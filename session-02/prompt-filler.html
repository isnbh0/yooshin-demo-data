<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>업무 흐름도 프롬프트 생성기</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap');

  *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}

  :root {
    --ink: #1a1a2e;
    --ink-light: #4a4a5a;
    --ink-muted: #8888a0;
    --surface: #f7f6f3;
    --surface-warm: #efeee9;
    --card: #ffffff;
    --border: #d8d6cf;
    --border-light: #e8e6df;
    --accent: #01579b;
    --accent-light: #e1f5fe;
    --accent-hover: #0277bd;
    --success: #2e7d32;
    --success-bg: #e8f5e9;
    --radius: 6px;
    --shadow-sm: 0 1px 2px rgba(0,0,0,.06);
    --shadow: 0 2px 8px rgba(0,0,0,.08);
    --shadow-lg: 0 4px 16px rgba(0,0,0,.1);
    --font: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, sans-serif;
    --mono: 'IBM Plex Mono', 'SF Mono', Consolas, monospace;
  }

  html { font-size: 15px; }

  body {
    font-family: var(--font);
    background: var(--surface);
    color: var(--ink);
    line-height: 1.6;
    min-height: 100vh;
    -webkit-font-smoothing: antialiased;
  }

  /* ── Header ── */
  .header {
    background: var(--card);
    border-bottom: 1px solid var(--border);
    padding: 1.2rem 2rem;
    position: sticky;
    top: 0;
    z-index: 100;
    box-shadow: var(--shadow-sm);
  }

  .header-inner {
    max-width: 1400px;
    margin: 0 auto;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 1rem;
  }

  .header h1 {
    font-size: 1.1rem;
    font-weight: 600;
    letter-spacing: -0.01em;
    color: var(--ink);
  }

  .header-tag {
    font-size: 0.72rem;
    font-weight: 500;
    color: var(--accent);
    background: var(--accent-light);
    padding: 0.25rem 0.6rem;
    border-radius: 3px;
    letter-spacing: 0.02em;
    white-space: nowrap;
  }

  /* ── Layout ── */
  .container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 1.5rem 2rem 3rem;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.5rem;
    align-items: start;
  }

  /* ── Panel shared ── */
  .panel {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    box-shadow: var(--shadow);
  }

  .panel-header {
    padding: 1rem 1.25rem;
    border-bottom: 1px solid var(--border-light);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 0.75rem;
  }

  .panel-title {
    font-size: 0.82rem;
    font-weight: 600;
    color: var(--ink-light);
    text-transform: uppercase;
    letter-spacing: 0.06em;
  }

  .panel-body {
    padding: 1.25rem;
  }

  /* ── Form ── */
  .form-group {
    margin-bottom: 1.25rem;
  }

  .form-group:last-child {
    margin-bottom: 0;
  }

  .form-label {
    display: block;
    font-size: 0.85rem;
    font-weight: 500;
    color: var(--ink);
    margin-bottom: 0.4rem;
  }

  .form-hint {
    font-size: 0.75rem;
    color: var(--ink-muted);
    margin-bottom: 0.4rem;
    line-height: 1.5;
  }

  .form-input,
  .form-textarea {
    width: 100%;
    font-family: var(--font);
    font-size: 0.9rem;
    color: var(--ink);
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 0.6rem 0.8rem;
    transition: border-color 0.15s, box-shadow 0.15s;
    outline: none;
  }

  .form-input:focus,
  .form-textarea:focus {
    border-color: var(--accent);
    box-shadow: 0 0 0 3px rgba(1,87,155,.1);
  }

  .form-input::placeholder,
  .form-textarea::placeholder {
    color: var(--ink-muted);
  }

  .form-textarea {
    resize: vertical;
    line-height: 1.6;
  }

  .form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
  }

  .form-actions {
    display: flex;
    gap: 0.5rem;
    margin-top: 0.75rem;
  }

  .btn-clear {
    font-family: var(--font);
    font-size: 0.78rem;
    font-weight: 500;
    color: var(--ink-muted);
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 0.4rem 0.9rem;
    cursor: pointer;
    transition: all 0.15s;
  }

  .btn-clear:hover {
    color: var(--ink-light);
    border-color: var(--ink-muted);
  }

  /* ── Output panel ── */
  .output-col {
    position: sticky;
    top: calc(3.6rem + 1.5rem);
    max-height: calc(100vh - 3.6rem - 3rem);
    display: flex;
    flex-direction: column;
  }

  .output-panel {
    display: flex;
    flex-direction: column;
    max-height: 100%;
    overflow: hidden;
  }

  .output-actions {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .btn-copy {
    font-family: var(--font);
    font-size: 0.8rem;
    font-weight: 500;
    color: #fff;
    background: var(--accent);
    border: none;
    border-radius: var(--radius);
    padding: 0.45rem 1rem;
    cursor: pointer;
    transition: all 0.15s;
    display: flex;
    align-items: center;
    gap: 0.4rem;
    white-space: nowrap;
  }

  .btn-copy:hover {
    background: var(--accent-hover);
  }

  .btn-copy.copied {
    background: var(--success);
  }

  .btn-copy svg {
    width: 14px;
    height: 14px;
    flex-shrink: 0;
  }

  .char-count {
    font-size: 0.72rem;
    font-family: var(--mono);
    color: var(--ink-muted);
  }

  .output-scroll {
    overflow-y: auto;
    flex: 1;
    min-height: 0;
  }

  .output-content {
    padding: 1.25rem;
    font-size: 0.82rem;
    font-family: var(--mono);
    line-height: 1.7;
    white-space: pre-wrap;
    word-break: break-word;
    color: var(--ink);
    tab-size: 2;
  }

  .output-placeholder {
    padding: 2.5rem 1.5rem;
    text-align: center;
    color: var(--ink-muted);
  }

  .output-placeholder .icon {
    font-size: 2rem;
    margin-bottom: 0.75rem;
    opacity: 0.4;
  }

  .output-placeholder p {
    font-size: 0.85rem;
    line-height: 1.6;
  }

  .output-placeholder .fields-status {
    margin-top: 1rem;
    display: flex;
    flex-direction: column;
    gap: 0.35rem;
    align-items: center;
  }

  .field-status {
    font-size: 0.78rem;
    display: flex;
    align-items: center;
    gap: 0.4rem;
  }

  .field-status .dot {
    width: 7px;
    height: 7px;
    border-radius: 50%;
    background: var(--border);
    flex-shrink: 0;
  }

  .field-status.filled .dot {
    background: var(--success);
  }

  /* ── Scrollbar ── */
  .output-scroll::-webkit-scrollbar { width: 6px; }
  .output-scroll::-webkit-scrollbar-track { background: transparent; }
  .output-scroll::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }
  .output-scroll::-webkit-scrollbar-thumb:hover { background: var(--ink-muted); }

  /* ── Responsive ── */
  @media (max-width: 900px) {
    .container {
      grid-template-columns: 1fr;
      padding: 1rem;
    }

    .output-col {
      position: static;
      max-height: none;
    }

    .output-panel {
      max-height: 70vh;
    }

    .header { padding: 1rem; }
    .header h1 { font-size: 1rem; }
  }

  @media (max-width: 600px) {
    html { font-size: 14px; }
    .form-row { grid-template-columns: 1fr; }
    .header-inner { flex-direction: column; align-items: flex-start; gap: 0.4rem; }
  }
</style>
</head>
<body>

<header class="header">
  <div class="header-inner">
    <h1>업무 흐름도 프롬프트 생성기</h1>
    <span class="header-tag">Session 2</span>
  </div>
</header>

<main class="container">

  <!-- ═══ Left: Form ═══ -->
  <div class="panel">
    <div class="panel-header">
      <span class="panel-title">입력</span>
      <button class="btn-clear" onclick="clearAll()" title="모든 필드 초기화">초기화</button>
    </div>
    <div class="panel-body">

      <div class="form-row">
        <div class="form-group">
          <label class="form-label" for="name">이름</label>
          <input class="form-input" type="text" id="name" placeholder="홍길동" autocomplete="off">
        </div>
        <div class="form-group">
          <label class="form-label" for="dept">부서</label>
          <input class="form-input" type="text" id="dept" placeholder="총무부" autocomplete="off">
        </div>
      </div>

      <div class="form-group">
        <label class="form-label" for="topic">만들고 싶은 흐름도 주제</label>
        <div class="form-hint">어떤 업무 프로세스를 다이어그램으로 만들고 싶은지 적어주세요</div>
        <input class="form-input" type="text" id="topic" placeholder="예: 출장 정산, 구매 요청 처리, 계약서 검토" autocomplete="off">
      </div>

      <div class="form-group">
        <label class="form-label" for="context">업무 맥락 문서</label>
        <div class="form-hint">세션 1 과제로 작성한 업무 맥락 문서를 붙여넣기 하세요</div>
        <textarea class="form-textarea" id="context" rows="14" placeholder="업무 맥락 문서 내용을 여기에 붙여넣기..."></textarea>
      </div>

    </div>
  </div>

  <!-- ═══ Right: Output ═══ -->
  <div class="output-col">
    <div class="panel output-panel">
      <div class="panel-header">
        <span class="panel-title">프롬프트</span>
        <div class="output-actions">
          <span class="char-count" id="charCount"></span>
          <button class="btn-copy" id="copyBtn" onclick="copyPrompt()">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
            <span id="copyLabel">복사</span>
          </button>
        </div>
      </div>
      <div class="output-scroll">
        <div id="output"></div>
      </div>
    </div>
  </div>

</main>

<script>
const STORAGE_KEY = 'yooshin-s2-prompt-filler';

const DIAGRAM_SPEC = `# 업무 흐름도 작성 규격

## 개요

이 문서는 업무 프로세스를 Mermaid 다이어그램으로 표현할 때의 규격입니다. AI에게 업무 흐름도를 요청할 때 이 문서를 함께 첨부하세요.

## 노드 유형

업무 흐름도에는 **두 가지 유형의 노드만** 사용합니다.

### 산출물 (Artifact)

업무에서 만들어지거나 사용되는 문서, 데이터, 파일, 보고서 등.

\`\`\`
산출물명[("산출물 이름")]
\`\`\`

실린더(원통) 모양으로 표현됩니다.

### 프로세스 (Process)

사람이 수행하는 작업, 절차, 활동 등.

\`\`\`
프로세스명[["프로세스 이름"]]:::proc
\`\`\`

이중 테두리 사각형으로 표현되며, \`:::proc\` 스타일을 적용합니다.

## 연결 규칙

### 화살표 유형

| 화살표 | 의미 | 사용 |
|---|---|---|
| \`-->\` | 생산/소비 | 프로세스가 산출물을 만들거나, 산출물이 프로세스의 주요 입력일 때 |
| \`-.->\` | 참조 | 프로세스가 산출물을 참고만 할 때 (기준, 규정, 양식 등) |

### 교대 규칙

산출물과 프로세스는 **반드시 교대로** 연결합니다:

- 산출물 → 프로세스 → 산출물 → 프로세스 → ...
- 프로세스끼리 직접 연결하지 않습니다
- 산출물끼리 직접 연결하지 않습니다

### 흐름 방향

\`flowchart TD\` (위에서 아래)를 사용합니다.

## 스타일 정의

다이어그램 마지막에 반드시 아래 스타일을 포함합니다:

\`\`\`
classDef proc fill:#e1f5fe,stroke:#01579b,stroke-width:2px,color:#000
\`\`\`

## 목표 복잡도

- 전체 노드 수: **10~15개**
- 산출물과 프로세스가 적절히 섞여야 합니다

## 기본 템플릿

\`\`\`
flowchart TD
    산출물1[("산출물 1")]
    프로세스1[["프로세스 1"]]:::proc
    산출물2[("산출물 2")]
    프로세스2[["프로세스 2"]]:::proc
    산출물3[("산출물 3")]

    산출물1 --> 프로세스1 --> 산출물2 --> 프로세스2 --> 산출물3

    classDef proc fill:#e1f5fe,stroke:#01579b,stroke-width:2px,color:#000
\`\`\`

## 예시: 출장 정산 업무

아래는 출장 정산 업무를 이 규격으로 표현한 예시입니다 (10개 노드: 산출물 6, 프로세스 4).

\`\`\`
flowchart TD
    출장규정[("출장 규정")]
    출장계획서[("출장 계획서")]
    출장승인[["출장 승인"]]:::proc
    승인서[("출장 승인서")]
    출장수행[["출장 수행"]]:::proc
    영수증[("영수증/증빙")]
    정산작성[["정산서 작성"]]:::proc
    정산서[("출장 정산서")]
    정산검토[["정산 검토 및 승인"]]:::proc
    정산보고[("정산 완료 보고")]

    출장계획서 --> 출장승인 --> 승인서
    승인서 --> 출장수행 --> 영수증
    영수증 --> 정산작성 --> 정산서
    정산서 --> 정산검토 --> 정산보고

    출장규정 -.-> 출장승인
    출장계획서 -.-> 정산작성
    출장규정 -.-> 정산검토

    classDef proc fill:#e1f5fe,stroke:#01579b,stroke-width:2px,color:#000
\`\`\`

### 예시 해설

- **실선 화살표** (\`-->\`): 출장계획서가 출장승인의 입력이 되고, 출장승인이 승인서를 만들어내는 흐름
- **점선 화살표** (\`-.->\`): 출장규정은 승인과 검토 시 참고만 하므로 점선으로 연결
- **교대 규칙**: 산출물과 프로세스가 번갈아 나타남
- **출장규정**: 흐름의 시작이 아닌, 여러 프로세스가 참조하는 독립 산출물`;

// ── Elements ──
const $name = document.getElementById('name');
const $dept = document.getElementById('dept');
const $topic = document.getElementById('topic');
const $context = document.getElementById('context');
const $output = document.getElementById('output');
const $charCount = document.getElementById('charCount');
const $copyBtn = document.getElementById('copyBtn');
const $copyLabel = document.getElementById('copyLabel');

const fields = [$name, $dept, $topic, $context];

// ── Render ──
function getPromptText() {
  const name = $name.value.trim();
  const dept = $dept.value.trim();
  const topic = $topic.value.trim();
  const context = $context.value.trim();

  return `# 업무 흐름도 작성 요청

## 내 정보
- 이름: ${name}
- 부서: ${dept}

## 만들고 싶은 흐름도
${topic}

## 내 업무 맥락
${context}

---

## 작성 규격

${DIAGRAM_SPEC}

---

## 진행 방법

위 규격에 맞는 Mermaid 업무 흐름도를 만들어주세요. 아래 절차를 따라주세요:

1. 먼저 내 업무 맥락과 흐름도 주제를 확인한 뒤, 해당 업무의 구체적인 절차에 대해 **인터뷰**해주세요.
2. 한 번에 하나씩 질문하세요. 필요한 정보가 충분히 모일 때까지 계속 질문합니다.
3. 충분한 정보가 모이면, 위 작성 규격에 맞는 Mermaid 다이어그램 코드를 작성해주세요.
4. 다이어그램은 10~15개 노드를 목표로 합니다.
5. 작성 후 각 노드와 연결에 대한 간단한 해설을 덧붙여주세요.`;
}

function isReady() {
  return $name.value.trim() && $dept.value.trim() && $topic.value.trim() && $context.value.trim();
}

function render() {
  if (isReady()) {
    const text = getPromptText();
    $output.className = 'output-content';
    $output.textContent = text;
    $charCount.textContent = text.length.toLocaleString() + '자';
    $copyBtn.style.display = '';
  } else {
    renderPlaceholder();
    $charCount.textContent = '';
    $copyBtn.style.display = 'none';
  }
  save();
}

function renderPlaceholder() {
  const fieldInfo = [
    { id: 'name', label: '이름' },
    { id: 'dept', label: '부서' },
    { id: 'topic', label: '흐름도 주제' },
    { id: 'context', label: '업무 맥락 문서' },
  ];

  let html = '<div class="output-placeholder">';
  html += '<div class="icon">&#9998;</div>';
  html += '<p>왼쪽 양식을 작성하면<br>프롬프트가 자동으로 완성됩니다</p>';
  html += '<div class="fields-status">';
  for (const f of fieldInfo) {
    const el = document.getElementById(f.id);
    const filled = el && el.value.trim();
    html += `<span class="field-status ${filled ? 'filled' : ''}"><span class="dot"></span>${f.label}</span>`;
  }
  html += '</div></div>';
  $output.className = '';
  $output.innerHTML = html;
}

// ── Copy ──
function copyPrompt() {
  if (!isReady()) return;
  const text = getPromptText();
  navigator.clipboard.writeText(text).then(() => {
    $copyBtn.classList.add('copied');
    $copyLabel.textContent = '복사 완료!';
    setTimeout(() => {
      $copyBtn.classList.remove('copied');
      $copyLabel.textContent = '복사';
    }, 2000);
  });
}

// ── Persistence ──
function save() {
  try {
    localStorage.setItem(STORAGE_KEY, JSON.stringify({
      name: $name.value,
      dept: $dept.value,
      topic: $topic.value,
      context: $context.value,
    }));
  } catch (e) { /* quota exceeded, ignore */ }
}

function load() {
  try {
    const data = JSON.parse(localStorage.getItem(STORAGE_KEY));
    if (!data) return;
    if (data.name) $name.value = data.name;
    if (data.dept) $dept.value = data.dept;
    if (data.topic) $topic.value = data.topic;
    if (data.context) $context.value = data.context;
  } catch (e) { /* corrupt data, ignore */ }
}

function clearAll() {
  fields.forEach(f => f.value = '');
  localStorage.removeItem(STORAGE_KEY);
  render();
  $name.focus();
}

// ── Init ──
fields.forEach(f => f.addEventListener('input', render));
load();
render();
</script>
</body>
</html>
